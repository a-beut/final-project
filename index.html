<!DOCTYPE html>
<html lang="en">
    <head>
        <link href="style.css" type="text/css" rel="stylesheet">
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <title>Suntracker</title>
    </head>
    <body>
        <!--<a href="https://www.flaticon.com/free-icons/sunset" title="sunset icons">Sunset icons created by Mehwish - Flaticon</a>-->
        <!--<a href="https://www.flaticon.com/free-icons/sunrise" title="sunrise icons">Sunrise icons created by Mehwish - Flaticon</a>-->

        <!--Header Bar-->
        <div class="container-fluid" id="header">
            <div class="row">
                <div class="col">
                    <h1>Suntracker</h1>
                </div>
            </div>
        </div>
        <!--Main Page-->
        <div class="container" id="form-module">
            <div class="row">
                <div class="col-12">
                    <form id="input-form">
                        <label for="latitude">Latitude:</label>
                        <input type="number" id="latitude" name="latitude" required>
                        <label for="longitude">Longitude:</label>
                        <input type="number" id="longitude" name="longitude" required>
                        <label for="sundate">Date:</label>
                        <input type="date" id="sundate" name="sundate" required>
                        <input type="button" id="submit-button" value="Submit">
                    </form>
                </div>
            </div>
        </div>
            <!--Container for API data-->
        <div class="container" id="display-module"></div>
            <div class="row">
                <div class="col">
                    <img src="images/sunrise.png" alt="an icon of a sunrise">
                    <div class="time-display" id="sunrise-time">
                        <p>Sunrise time will be displayed here</p>
                    </div>
                </div>
                <div class="col">
                    <img src="images/sunset.png" alt="an icon of a sunset">
                    <div class="time-display" id="sunset-time">
                        <p>Sunset time will be displayed here</p>
                    </div>
                </div>
            </div>
        </div>
        
        <script>
            // call API
            function getTimes(){
                var url = buildURL();
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var resultsObject = JSON.parse(this.responseText);
                    console.log(resultsObject);
                    //console.log(resultsObject.results.sunset);
                    //console.log(resultsObject.results.sunrise);
                    displaySunset(resultsObject.results.sunset);
                    displaySunrise(resultsObject.results.sunrise);
                }
            };
                xhttp.open("GET", url,true);
                xhttp.send();
            }
            // build link
            function buildURL(){
                var baseURL = 'https://api.sunrise-sunset.org/json?';
                //variables for lat lon and date;
                var latitude = document.getElementById('latitude').value;
                var longitude = document.getElementById('longitude').value;
                var date = document.getElementById('sundate').value;
                console.log(date);
                var finishedURL = baseURL+'lat='+latitude+'&lng='+longitude+'&date='+date;
                console.log(finishedURL)
                return finishedURL;
            }
            // display Sunset time
            function displaySunset(time){
                var displayedSunset = document.getElementById("sunset-time");
                displayedSunset.innerHTML = time;
                console.log('displayed time',displayedSunset);
            }
            // display Sunrise time
            function displaySunrise(time){
                var displayedSunrise = document.getElementById("sunrise-time");
                displayedSunrise.innerHTML = time;
            }
            const formElement=document.getElementById('submit-button');
            formElement.addEventListener('click',getTimes,false);
        </script>
    </body>
</html>